/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";const t="https://story-api.dicoding.dev/v1";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function e(){var t=c(),n=t.m(e),f=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function l(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===f||"GeneratorFunction"===(n.displayName||n.name))}var p={throw:1,return:2,break:3,continue:3};function y(t){var n,e;return function(o){n||(n={stop:function(){return e(o.a,2)},catch:function(){return o.v},abrupt:function(t,n){return e(o.a,p[t],n)},delegateYield:function(t,i,a){return n.resultName=i,e(o.d,r(t),a)},finish:function(t){return e(o.f,t)}},e=function(t,e,r){o.p=n.prev,o.n=n.next;try{return t(e,r)}finally{n.next=o.n}}),n.resultName&&(n[n.resultName]=o.v,n.resultName=void 0),n.sent=o.v,n.next=o.n;try{return t.call(this,n)}finally{o.p=n.prev,o.n=n.next}}}return(e=function(){return{wrap:function(n,e,r,o){return t.w(y(n),e,r,o&&o.reverse())},isGeneratorFunction:l,mark:t.m,awrap:function(t,n){return new s(t,n)},AsyncIterator:u,async:function(t,n,e,r,o){return(l(n)?a:i)(y(t),n,e,r,o)},keys:o,values:r}})()}function r(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(n(t)+" is not iterable")}function o(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function i(t,n,e,r,o){var i=a(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function a(t,n,e,r,o){return new u(c().w(t,n,e,r),o||Promise)}function u(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof s?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(f(u.prototype),f(u.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),f(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function c(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,s=Object.create(c.prototype);return f(s,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),s}var a={};function u(){}function s(){}function l(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(f(n={},r,(function(){return this})),n),y=l.prototype=u.prototype=Object.create(p);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,f(t,o,"GeneratorFunction")),t.prototype=Object.create(y),t}return s.prototype=l,f(y,"constructor",l),f(l,"constructor",s),s.displayName="GeneratorFunction",f(l,o,"GeneratorFunction"),f(y),f(y,o,"Generator"),f(y,r,(function(){return this})),f(y,"toString",(function(){return"[object Generator]"})),(c=function(){return{w:i,m:v}})()}function f(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}f=function(t,n,e,r){function i(n,e){f(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},f(t,n,e,r)}function s(t,n){this.v=t,this.k=n}function l(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function p(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){l(i,r,o,a,u,"next",t)}function u(t){l(i,r,o,a,u,"throw",t)}a(void 0)}))}}var y={REGISTER:"".concat(t,"/register"),LOGIN:"".concat(t,"/login"),STORIES:"".concat(t,"/stories"),STORIES_GUEST:"".concat(t,"/stories/guest"),NOTIFICATION:"".concat(t,"/notifications/subscribe")};function v(t){return d.apply(this,arguments)}function d(){return(d=p(e().mark((function t(n){var r;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=null,t.prev=1,t.next=4,n.json();case 4:r=t.sent,t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(1),new Error("Response server tidak valid");case 10:if(n.ok&&!r.error){t.next=12;break}throw new Error(r.message||"Terjadi kesalahan");case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}}),t,null,[[1,7]])})))).apply(this,arguments)}function h(t){return m.apply(this,arguments)}function m(){return(m=p(e().mark((function t(n){var r,o,i,a;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.name,o=n.email,i=n.password,t.next=3,fetch(y.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:o,password:i})});case 3:return a=t.sent,t.abrupt("return",v(a));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function b(t){return g.apply(this,arguments)}function g(){return(g=p(e().mark((function t(n){var r,o,i;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.email,o=n.password,t.next=3,fetch(y.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:o})});case 3:return i=t.sent,t.abrupt("return",v(i));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(t){return x.apply(this,arguments)}function x(){return x=p(e().mark((function t(n){var r,o,i,a=arguments;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:1,o=a.length>2&&void 0!==a[2]?a[2]:10,t.next=4,fetch("".concat(y.STORIES,"?page=").concat(r,"&size=").concat(o,"&location=1"),{headers:{Authorization:"Bearer ".concat(n)}});case 4:return i=t.sent,t.abrupt("return",v(i));case 6:case"end":return t.stop()}}),t)}))),x.apply(this,arguments)}function k(t,n){return S.apply(this,arguments)}function S(){return(S=p(e().mark((function t(n,r){var o;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(y.STORIES,{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:n});case 2:return o=t.sent,t.abrupt("return",v(o));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var O="token";function j(){return"undefined"==typeof localStorage?null:localStorage.getItem(O)}function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function T(){var t=F(),n=t.m(T),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,o[t],n)},delegateYield:function(t,o,i){return n.resultName=o,e(r.d,E(t),i)},finish:function(t){return e(r.f,t)}},e=function(t,e,o){r.p=n.prev,r.n=n.next;try{return t(e,o)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(T=function(){return{wrap:function(n,e,r,o){return t.w(i(n),e,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new A(t,n)},AsyncIterator:G,async:function(t,n,e,o,a){return(r(n)?I:N)(i(t),n,e,o,a)},keys:_,values:E}})()}function E(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(P(t)+" is not iterable")}function _(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function N(t,n,e,r,o){var i=I(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function I(t,n,e,r,o){return new G(F().w(t,n,e,r),o||Promise)}function G(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof A?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(B(G.prototype),B(G.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),B(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function F(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,f=Object.create(c.prototype);return B(f,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),f}var a={};function u(){}function c(){}function f(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(B(n={},r,(function(){return this})),n),l=f.prototype=u.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,B(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=f,B(l,"constructor",f),B(f,"constructor",c),c.displayName="GeneratorFunction",B(f,o,"GeneratorFunction"),B(l),B(l,o,"Generator"),B(l,r,(function(){return this})),B(l,"toString",(function(){return"[object Generator]"})),(F=function(){return{w:i,m:p}})()}function B(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}B=function(t,n,e,r){function i(n,e){B(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},B(t,n,e,r)}function A(t,n){this.v=t,this.k=n}function C(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function M(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){C(i,r,o,a,u,"next",t)}function u(t){C(i,r,o,a,u,"throw",t)}a(void 0)}))}}function R(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,D(r.key),r)}}function D(t){var n=function(t){if("object"!=P(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=P(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(n)?n:n+""}var q=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)},n=[{key:"render",value:(r=M(T().mark((function t(){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="main-content">\n        <h1 class="page-title">Daftar Story</h1>\n\n        \x3c!-- MAP --\x3e\n        <div class="map-wrapper" aria-label="Peta lokasi story">\n          <div id="map"></div>\n        </div>\n\n        \x3c!-- STORY LIST --\x3e\n        <section\n          id="storyList"\n          class="story-list"\n          aria-live="polite"\n          aria-busy="true"\n        ></section>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=M(T().mark((function t(){var n,e,r,o,i,a,u;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=j()){t.next=4;break}return location.hash="#/login",t.abrupt("return");case 4:if(e=document.getElementById("map")){t.next=7;break}return t.abrupt("return");case 7:return r=L.map(e).setView([-2.5,118],5),o=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap"}).addTo(r),i=L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenTopoMap"}),L.control.layers({OpenStreetMap:o,Topografi:i},null,{position:"topright"}).addTo(r),(a=document.getElementById("storyList")).innerHTML="<p>Memuat story...</p>",t.prev=13,t.next=16,w(n);case 16:u=t.sent,t.next=24;break;case 19:return t.prev=19,t.t0=t.catch(13),a.innerHTML='\n        <p class="error-text">Gagal memuat data story</p>\n      ',a.setAttribute("aria-busy","false"),t.abrupt("return");case 24:if(u.listStory&&0!==u.listStory.length){t.next=28;break}return a.innerHTML="<p>Belum ada story</p>",a.setAttribute("aria-busy","false"),t.abrupt("return");case 28:a.innerHTML="",a.setAttribute("aria-busy","false"),u.listStory.forEach((function(t){var n=document.createElement("article");if(n.className="story-card",n.tabIndex=0,n.setAttribute("aria-label","Story oleh ".concat(t.name)),n.innerHTML='\n        <img\n          src="'.concat(t.photoUrl,'"\n          alt="Foto story oleh ').concat(t.name,'"\n          loading="lazy"\n        />\n\n        <div class="story-card-content">\n          <h3>').concat(t.name,"</h3>\n          <p>").concat(t.description,'</p>\n          <time datetime="').concat(t.createdAt,'">\n            ').concat(new Date(t.createdAt).toLocaleString(),"\n          </time>\n        </div>\n      "),t.lat&&t.lon){var e=L.marker([t.lat,t.lon]).addTo(r);e.bindPopup("\n          <strong>".concat(t.name,"</strong><br />\n          ").concat(t.description,"\n        "));var o=function(){r.setView([t.lat,t.lon],10,{animate:!0}),e.openPopup()};n.addEventListener("click",o),n.addEventListener("keypress",(function(t){"Enter"===t.key&&o()}))}a.appendChild(n)}));case 31:case"end":return t.stop()}}),t,null,[[13,19]])}))),function(){return e.apply(this,arguments)})}],n&&R(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function H(){var t=K(),n=t.m(H),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,o[t],n)},delegateYield:function(t,o,i){return n.resultName=o,e(r.d,Y(t),i)},finish:function(t){return e(r.f,t)}},e=function(t,e,o){r.p=n.prev,r.n=n.next;try{return t(e,o)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(H=function(){return{wrap:function(n,e,r,o){return t.w(i(n),e,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new Q(t,n)},AsyncIterator:V,async:function(t,n,e,o,a){return(r(n)?J:U)(i(t),n,e,o,a)},keys:W,values:Y}})()}function Y(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(z(t)+" is not iterable")}function W(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function U(t,n,e,r,o){var i=J(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function J(t,n,e,r,o){return new V(K().w(t,n,e,r),o||Promise)}function V(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof Q?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||($(V.prototype),$(V.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),$(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function K(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,f=Object.create(c.prototype);return $(f,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),f}var a={};function u(){}function c(){}function f(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):($(n={},r,(function(){return this})),n),l=f.prototype=u.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,$(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=f,$(l,"constructor",f),$(f,"constructor",c),c.displayName="GeneratorFunction",$(f,o,"GeneratorFunction"),$(l),$(l,o,"Generator"),$(l,r,(function(){return this})),$(l,"toString",(function(){return"[object Generator]"})),(K=function(){return{w:i,m:p}})()}function $(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}$=function(t,n,e,r){function i(n,e){$(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},$(t,n,e,r)}function Q(t,n){this.v=t,this.k=n}function X(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function Z(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){X(i,r,o,a,u,"next",t)}function u(t){X(i,r,o,a,u,"throw",t)}a(void 0)}))}}function tt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nt(r.key),r)}}function nt(t){var n=function(t){if("object"!=z(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=z(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(n)?n:n+""}var et=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)},n=[{key:"render",value:(r=Z(H().mark((function t(){return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth-container">\n        <h1>Login</h1>\n\n        <form id="loginForm" class="auth-form" novalidate>\n          <label for="loginEmail">Email</label>\n          <input\n            type="email"\n            id="loginEmail"\n            required\n            aria-required="true"\n            autocomplete="username"\n            placeholder="email@example.com"\n          />\n\n          <label for="loginPassword">Password</label>\n          <input\n            type="password"\n            id="loginPassword"\n            required\n            aria-required="true"\n            minlength="8"\n            autocomplete="current-password"\n            placeholder="Minimal 8 karakter"\n          />\n\n          <button type="submit" class="btn-primary" id="loginBtn">\n            Login\n          </button>\n        </form>\n\n        <p class="auth-switch">\n          Belum punya akun?\n          <a href="#/register" class="link-button">Daftar</a>\n        </p>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=Z(H().mark((function t(){var n,e;return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!localStorage.getItem("token")){t.next=4;break}return location.hash="#/",t.abrupt("return");case 4:n=document.getElementById("loginForm"),e=document.getElementById("loginBtn"),n.addEventListener("submit",function(){var t=Z(H().mark((function t(n){var r,o,i;return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),r=document.getElementById("loginEmail").value.trim(),o=document.getElementById("loginPassword").value.trim(),r&&o){t.next=6;break}return alert("Email dan password wajib diisi"),t.abrupt("return");case 6:return e.disabled=!0,e.textContent="Memproses...",t.prev=8,t.next=11,b({email:r,password:o});case 11:if(!(i=t.sent).error){t.next=15;break}return alert(i.message),t.abrupt("return");case 15:localStorage.setItem("token",i.loginResult.token),localStorage.setItem("name",i.loginResult.name),location.hash="#/",t.next=24;break;case 20:t.prev=20,t.t0=t.catch(8),console.error(t.t0),alert("Login gagal, periksa koneksi atau data Anda");case 24:return t.prev=24,e.disabled=!1,e.textContent="Login",t.finish(24);case 28:case"end":return t.stop()}}),t,null,[[8,20,24,28]])})));return function(n){return t.apply(this,arguments)}}());case 7:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})}],n&&tt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r}();function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function ot(){var t=st(),n=t.m(ot),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,o[t],n)},delegateYield:function(t,o,i){return n.resultName=o,e(r.d,it(t),i)},finish:function(t){return e(r.f,t)}},e=function(t,e,o){r.p=n.prev,r.n=n.next;try{return t(e,o)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(ot=function(){return{wrap:function(n,e,r,o){return t.w(i(n),e,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new pt(t,n)},AsyncIterator:ft,async:function(t,n,e,o,a){return(r(n)?ct:ut)(i(t),n,e,o,a)},keys:at,values:it}})()}function it(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(rt(t)+" is not iterable")}function at(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function ut(t,n,e,r,o){var i=ct(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function ct(t,n,e,r,o){return new ft(st().w(t,n,e,r),o||Promise)}function ft(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof pt?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(lt(ft.prototype),lt(ft.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),lt(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function st(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,f=Object.create(c.prototype);return lt(f,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),f}var a={};function u(){}function c(){}function f(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(lt(n={},r,(function(){return this})),n),l=f.prototype=u.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,lt(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=f,lt(l,"constructor",f),lt(f,"constructor",c),c.displayName="GeneratorFunction",lt(f,o,"GeneratorFunction"),lt(l),lt(l,o,"Generator"),lt(l,r,(function(){return this})),lt(l,"toString",(function(){return"[object Generator]"})),(st=function(){return{w:i,m:p}})()}function lt(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}lt=function(t,n,e,r){function i(n,e){lt(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},lt(t,n,e,r)}function pt(t,n){this.v=t,this.k=n}function yt(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function vt(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){yt(i,r,o,a,u,"next",t)}function u(t){yt(i,r,o,a,u,"throw",t)}a(void 0)}))}}function dt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ht(r.key),r)}}function ht(t){var n=function(t){if("object"!=rt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=rt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rt(n)?n:n+""}var mt=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)},n=[{key:"render",value:(r=vt(ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth-container">\n        <h1>Register</h1>\n\n        <form id="registerForm" class="auth-form" novalidate>\n          <label for="regName">Nama</label>\n          <input\n            type="text"\n            id="regName"\n            required\n            aria-required="true"\n            placeholder="Nama lengkap"\n          />\n\n          <label for="regEmail">Email</label>\n          <input\n            type="email"\n            id="regEmail"\n            required\n            aria-required="true"\n            autocomplete="username"\n            placeholder="email@example.com"\n          />\n\n          <label for="regPassword">Password</label>\n          <input\n            type="password"\n            id="regPassword"\n            required\n            aria-required="true"\n            minlength="8"\n            autocomplete="new-password"\n            placeholder="Minimal 8 karakter"\n          />\n\n          <button type="submit" class="btn-primary" id="registerBtn">\n            Daftar\n          </button>\n        </form>\n\n        <p class="auth-switch">\n          Sudah punya akun?\n          <a href="#/login" class="link-button">Login</a>\n        </p>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=vt(ot().mark((function t(){var n,e;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!localStorage.getItem("token")){t.next=4;break}return location.hash="#/",t.abrupt("return");case 4:n=document.getElementById("registerForm"),e=document.getElementById("registerBtn"),n.addEventListener("submit",function(){var t=vt(ot().mark((function t(n){var r,o,i,a;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),r=document.getElementById("regName").value.trim(),o=document.getElementById("regEmail").value.trim(),i=document.getElementById("regPassword").value.trim(),r&&o&&i){t.next=7;break}return alert("Semua field wajib diisi"),t.abrupt("return");case 7:if(!(i.length<8)){t.next=10;break}return alert("Password minimal 8 karakter"),t.abrupt("return");case 10:return e.disabled=!0,e.textContent="Memproses...",t.prev=12,t.next=15,h({name:r,email:o,password:i});case 15:if(!(a=t.sent).error){t.next=19;break}return alert(a.message),t.abrupt("return");case 19:alert("Registrasi berhasil, silakan login"),location.hash="#/login",t.next=27;break;case 23:t.prev=23,t.t0=t.catch(12),console.error(t.t0),alert("Registrasi gagal, periksa koneksi atau data Anda");case 27:return t.prev=27,e.disabled=!1,e.textContent="Daftar",t.finish(27);case 31:case"end":return t.stop()}}),t,null,[[12,23,27,31]])})));return function(n){return t.apply(this,arguments)}}());case 7:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})}],n&&dt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r}();function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function gt(){var t=jt(),n=t.m(gt),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,o[t],n)},delegateYield:function(t,o,i){return n.resultName=o,e(r.d,wt(t),i)},finish:function(t){return e(r.f,t)}},e=function(t,e,o){r.p=n.prev,r.n=n.next;try{return t(e,o)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(gt=function(){return{wrap:function(n,e,r,o){return t.w(i(n),e,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new Tt(t,n)},AsyncIterator:Ot,async:function(t,n,e,o,a){return(r(n)?St:kt)(i(t),n,e,o,a)},keys:xt,values:wt}})()}function wt(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(bt(t)+" is not iterable")}function xt(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function kt(t,n,e,r,o){var i=St(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function St(t,n,e,r,o){return new Ot(jt().w(t,n,e,r),o||Promise)}function Ot(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof Tt?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Pt(Ot.prototype),Pt(Ot.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Pt(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function jt(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,f=Object.create(c.prototype);return Pt(f,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),f}var a={};function u(){}function c(){}function f(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(Pt(n={},r,(function(){return this})),n),l=f.prototype=u.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,Pt(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=f,Pt(l,"constructor",f),Pt(f,"constructor",c),c.displayName="GeneratorFunction",Pt(f,o,"GeneratorFunction"),Pt(l),Pt(l,o,"Generator"),Pt(l,r,(function(){return this})),Pt(l,"toString",(function(){return"[object Generator]"})),(jt=function(){return{w:i,m:p}})()}function Pt(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Pt=function(t,n,e,r){function i(n,e){Pt(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},Pt(t,n,e,r)}function Tt(t,n){this.v=t,this.k=n}function Et(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function _t(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){Et(i,r,o,a,u,"next",t)}function u(t){Et(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Nt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,It(r.key),r)}}function It(t){var n=function(t){if("object"!=bt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=bt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bt(n)?n:n+""}var Gt=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)},n=[{key:"render",value:(r=_t(gt().mark((function t(){return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container">\n        <h1 class="page-title">Tambah Cerita</h1>\n\n        <form id="addStoryForm" class="story-form">\n          \x3c!-- DESKRIPSI --\x3e\n          <label for="description">Deskripsi Cerita</label>\n          <textarea\n            id="description"\n            name="description"\n            required\n            aria-required="true"\n            placeholder="Ceritakan pengalamanmu..."\n          ></textarea>\n\n          \x3c!-- FOTO --\x3e\n          <label for="photo">Foto</label>\n          <input\n            type="file"\n            id="photo"\n            name="photo"\n            accept="image/*"\n          />\n          <small>Bisa dari galeri atau kamera</small>\n\n          \x3c!-- KAMERA --\x3e\n          <div class="camera-control">\n            <button type="button" id="cameraBtn">ðŸ“· Gunakan Kamera</button>\n            <button type="button" id="captureBtn" hidden>Ambil Foto</button>\n          </div>\n\n          <video\n            id="cameraPreview"\n            autoplay\n            playsinline\n            hidden\n            aria-label="Preview kamera"\n          ></video>\n\n          \x3c!-- MAP --\x3e\n          <label>Pilih Lokasi (Opsional)</label>\n          <div id="map"></div>\n          <p id="locationInfo" class="location-info">\n            Klik peta untuk menentukan lokasi\n          </p>\n\n          <button type="submit" class="btn-primary">\n            Posting Cerita\n          </button>\n        </form>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=_t(gt().mark((function t(){var n,e,r,o,i,a,u,c,f,s,l,p,y,v;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=j()){t.next=4;break}return location.hash="#/login",t.abrupt("return");case 4:e=L.map("map").setView([-6.2,106.8],5),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap"}).addTo(e),r=null,o=null,i=null,e.on("click",(function(t){r=t.latlng.lat,o=t.latlng.lng,i&&i.remove(),i=L.marker(t.latlng).addTo(e),document.getElementById("locationInfo").textContent="Lokasi: ".concat(r.toFixed(4),", ").concat(o.toFixed(4))})),a=document.getElementById("cameraBtn"),u=document.getElementById("captureBtn"),c=document.getElementById("cameraPreview"),f=document.getElementById("photo"),s=null,l=function(){s&&(s.getTracks().forEach((function(t){return t.stop()})),s=null),c.hidden=!0,u.hidden=!0},p=function(){var t=_t(gt().mark((function t(){var n;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=navigator.mediaDevices)&&void 0!==n&&n.getUserMedia){t.next=3;break}return alert("Browser tidak mendukung kamera"),t.abrupt("return");case 3:return t.prev=3,t.next=6,navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1});case 6:s=t.sent,c.srcObject=s,c.hidden=!1,u.hidden=!1,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),alert("Izin kamera ditolak");case 15:case"end":return t.stop()}}),t,null,[[3,12]])})));return function(){return t.apply(this,arguments)}}(),a.addEventListener("click",p),u.addEventListener("click",(function(){var t=document.createElement("canvas");t.width=c.videoWidth,t.height=c.videoHeight,t.getContext("2d").drawImage(c,0,0),t.toBlob((function(t){var n=new File([t],"camera.jpg",{type:"image/jpeg",lastModified:Date.now()}),e=new DataTransfer;e.items.add(n),f.files=e.files}),"image/jpeg",.8),l()})),y=document.getElementById("addStoryForm"),v=y.querySelector('button[type="submit"]'),y.addEventListener("submit",function(){var t=_t(gt().mark((function t(e){var i,a,u;return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),i=document.getElementById("description").value.trim()){t.next=5;break}return alert("Deskripsi wajib diisi"),t.abrupt("return");case 5:return v.disabled=!0,v.textContent="Mengirim...",(a=new FormData).append("description",i),f.files[0]&&a.append("photo",f.files[0]),null!==r&&null!==o&&(a.append("lat",r),a.append("lon",o)),t.prev=11,t.next=14,k(a,n);case 14:u=t.sent,alert(u.message),l(),location.hash="#/",t.next=23;break;case 20:t.prev=20,t.t0=t.catch(11),alert("Gagal menambahkan cerita");case 23:return t.prev=23,v.disabled=!1,v.textContent="Posting Cerita",t.finish(23);case 27:case"end":return t.stop()}}),t,null,[[11,20,23,27]])})));return function(n){return t.apply(this,arguments)}}());case 22:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})}],n&&Nt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r}();const Ft={"/":new q,"/login":new et,"/register":new mt,"/add":new Gt};function Lt(){var t,n=document.getElementById("nav-list");n&&(j()?(n.innerHTML='\n      <li><a href="#/">Beranda</a></li>\n      <li><a href="#/add">Tambah Cerita</a></li>\n\n      <li>\n        <label class="push-toggle">\n          <input\n            type="checkbox"\n            id="pushToggle"\n            aria-label="Aktifkan Push Notification"\n          />\n          <span>Notifikasi</span>\n        </label>\n      </li>\n\n      <li>\n        <button\n          id="installBtn"\n          class="install-btn"\n          hidden\n          aria-label="Install Aplikasi"\n        >\n          Install\n        </button>\n      </li>\n\n      <li>\n        <button\n          id="logoutBtn"\n          class="logout-btn"\n          aria-label="Logout"\n        >\n          Logout\n        </button>\n      </li>\n    ',(t=document.getElementById("logoutBtn"))&&t.addEventListener("click",(function(){"undefined"!=typeof localStorage&&(localStorage.removeItem(O),localStorage.removeItem("name")),location.hash="#/login"}))):n.innerHTML='\n      <li><a href="#/login">Login</a></li>\n      <li><a href="#/register">Register</a></li>\n    ')}function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function At(){var t=zt(),n=t.m(At),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,o[t],n)},delegateYield:function(t,o,i){return n.resultName=o,e(r.d,Ct(t),i)},finish:function(t){return e(r.f,t)}},e=function(t,e,o){r.p=n.prev,r.n=n.next;try{return t(e,o)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(At=function(){return{wrap:function(n,e,r,o){return t.w(i(n),e,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new Yt(t,n)},AsyncIterator:qt,async:function(t,n,e,o,a){return(r(n)?Dt:Rt)(i(t),n,e,o,a)},keys:Mt,values:Ct}})()}function Ct(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(Bt(t)+" is not iterable")}function Mt(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Rt(t,n,e,r,o){var i=Dt(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function Dt(t,n,e,r,o){return new qt(zt().w(t,n,e,r),o||Promise)}function qt(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof Yt?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Ht(qt.prototype),Ht(qt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ht(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function zt(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,f=Object.create(c.prototype);return Ht(f,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),f}var a={};function u(){}function c(){}function f(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(Ht(n={},r,(function(){return this})),n),l=f.prototype=u.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,Ht(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=f,Ht(l,"constructor",f),Ht(f,"constructor",c),c.displayName="GeneratorFunction",Ht(f,o,"GeneratorFunction"),Ht(l),Ht(l,o,"Generator"),Ht(l,r,(function(){return this})),Ht(l,"toString",(function(){return"[object Generator]"})),(zt=function(){return{w:i,m:p}})()}function Ht(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Ht=function(t,n,e,r){function i(n,e){Ht(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},Ht(t,n,e,r)}function Yt(t,n){this.v=t,this.k=n}function Wt(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function Ut(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){Wt(i,r,o,a,u,"next",t)}function u(t){Wt(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Jt(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vt(r.key),r)}}function Vt(t){var n=function(t){if("object"!=Bt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=Bt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Bt(n)?n:n+""}var Kt=function(){return t=function t(n){var e=n.content;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._content=e},n=[{key:"renderPage",value:(e=Ut(At().mark((function t(){var n,e,r=this;return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=function(t){var n=t.resource,e=t.id;if(!n)return"/";var r="/".concat(n);return e&&(r+="/:id"),r}((o=window.location.hash.slice(1).toLowerCase()||"/",i=void 0,{resource:(i=o.split("/"))[1]||null,id:i[2]||null})),e=Ft[n],document.startViewTransition){t.next=10;break}return t.next=5,e.render();case 5:return this._content.innerHTML=t.sent,t.next=8,e.afterRender();case 8:return Lt(),t.abrupt("return");case 10:document.startViewTransition(Ut(At().mark((function t(){return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.render();case 2:return r._content.innerHTML=t.sent,t.next=5,e.afterRender();case 5:Lt();case 6:case"end":return t.stop()}}),t)}))));case 11:case"end":return t.stop()}var o,i}),t,this)}))),function(){return e.apply(this,arguments)})}],n&&Jt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e}();function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function Qt(){var t=rn(),n=t.m(Qt),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,o[t],n)},delegateYield:function(t,o,i){return n.resultName=o,e(r.d,Xt(t),i)},finish:function(t){return e(r.f,t)}},e=function(t,e,o){r.p=n.prev,r.n=n.next;try{return t(e,o)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(Qt=function(){return{wrap:function(n,e,r,o){return t.w(i(n),e,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new an(t,n)},AsyncIterator:en,async:function(t,n,e,o,a){return(r(n)?nn:tn)(i(t),n,e,o,a)},keys:Zt,values:Xt}})()}function Xt(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError($t(t)+" is not iterable")}function Zt(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function tn(t,n,e,r,o){var i=nn(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function nn(t,n,e,r,o){return new en(rn().w(t,n,e,r),o||Promise)}function en(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof an?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(on(en.prototype),on(en.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),on(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function rn(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,f=Object.create(c.prototype);return on(f,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),f}var a={};function u(){}function c(){}function f(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(on(n={},r,(function(){return this})),n),l=f.prototype=u.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,on(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=f,on(l,"constructor",f),on(f,"constructor",c),c.displayName="GeneratorFunction",on(f,o,"GeneratorFunction"),on(l),on(l,o,"Generator"),on(l,r,(function(){return this})),on(l,"toString",(function(){return"[object Generator]"})),(rn=function(){return{w:i,m:p}})()}function on(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}on=function(t,n,e,r){function i(n,e){on(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},on(t,n,e,r)}function an(t,n){this.v=t,this.k=n}function un(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function cn(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){un(i,r,o,a,u,"next",t)}function u(t){un(i,r,o,a,u,"throw",t)}a(void 0)}))}}var fn,sn="stories";function ln(){return new Promise((function(t,n){var e=indexedDB.open("dicoding-story-db",1);e.onupgradeneeded=function(t){var n=t.target.result;n.objectStoreNames.contains(sn)||n.createObjectStore(sn,{keyPath:"id"})},e.onsuccess=function(){return t(e.result)},e.onerror=function(){return n(e.error)}}))}function pn(){return yn.apply(this,arguments)}function yn(){return(yn=cn(Qt().mark((function t(){var n,e;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ln();case 2:return n=t.sent,e=n.transaction(sn,"readonly"),t.abrupt("return",e.objectStore(sn).getAll());case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function vn(){return dn.apply(this,arguments)}function dn(){return(dn=cn(Qt().mark((function t(){var n,e;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ln();case 2:return n=t.sent,(e=n.transaction(sn,"readwrite")).objectStore(sn).clear(),t.abrupt("return",e.complete);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function hn(t){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hn(t)}function mn(){var t=Sn(),n=t.m(mn),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,o[t],n)},delegateYield:function(t,o,i){return n.resultName=o,e(r.d,bn(t),i)},finish:function(t){return e(r.f,t)}},e=function(t,e,o){r.p=n.prev,r.n=n.next;try{return t(e,o)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(mn=function(){return{wrap:function(n,e,r,o){return t.w(i(n),e,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new jn(t,n)},AsyncIterator:kn,async:function(t,n,e,o,a){return(r(n)?xn:wn)(i(t),n,e,o,a)},keys:gn,values:bn}})()}function bn(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(hn(t)+" is not iterable")}function gn(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function wn(t,n,e,r,o){var i=xn(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function xn(t,n,e,r,o){return new kn(Sn().w(t,n,e,r),o||Promise)}function kn(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof jn?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(On(kn.prototype),On(kn.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),On(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function Sn(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,f=Object.create(c.prototype);return On(f,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),f}var a={};function u(){}function c(){}function f(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(On(n={},r,(function(){return this})),n),l=f.prototype=u.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,On(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=f,On(l,"constructor",f),On(f,"constructor",c),c.displayName="GeneratorFunction",On(f,o,"GeneratorFunction"),On(l),On(l,o,"Generator"),On(l,r,(function(){return this})),On(l,"toString",(function(){return"[object Generator]"})),(Sn=function(){return{w:i,m:p}})()}function On(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}On=function(t,n,e,r){function i(n,e){On(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},On(t,n,e,r)}function jn(t,n){this.v=t,this.k=n}function Pn(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return Tn(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Tn(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}function Tn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function En(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function _n(){var t;return t=mn().mark((function t(){var n,e,r,o,i,a;return mn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(navigator.onLine){t.next=2;break}return t.abrupt("return");case 2:if(n=localStorage.getItem("token")){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,pn();case 7:if((e=t.sent).length){t.next=10;break}return t.abrupt("return");case 10:r=Pn(e),t.prev=11,r.s();case 13:if((o=r.n()).done){t.next=31;break}return i=o.value,(a=new FormData).append("description",i.description),a.append("photo",i.photo),i.lat&&a.append("lat",i.lat),i.lon&&a.append("lon",i.lon),t.prev=20,t.next=23,fetch("https://story-api.dicoding.dev/v1/stories",{method:"POST",headers:{Authorization:"Bearer ".concat(n)},body:a});case 23:t.next=29;break;case 25:return t.prev=25,t.t0=t.catch(20),console.error("Sync gagal",t.t0),t.abrupt("return");case 29:t.next=13;break;case 31:t.next=36;break;case 33:t.prev=33,t.t1=t.catch(11),r.e(t.t1);case 36:return t.prev=36,r.f(),t.finish(36);case 39:return t.next=41,vn();case 41:console.log("Offline stories synced");case 42:case"end":return t.stop()}}),t,null,[[11,33,36,39],[20,25]])})),_n=function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){En(i,r,o,a,u,"next",t)}function u(t){En(i,r,o,a,u,"throw",t)}a(void 0)}))},_n.apply(this,arguments)}function Nn(t){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(t)}function In(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function Gn(){var t=Mn(),n=t.m(Gn),e=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function r(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===e||"GeneratorFunction"===(n.displayName||n.name))}var o={throw:1,return:2,break:3,continue:3};function i(t){var n,e;return function(r){n||(n={stop:function(){return e(r.a,2)},catch:function(){return r.v},abrupt:function(t,n){return e(r.a,o[t],n)},delegateYield:function(t,o,i){return n.resultName=o,e(r.d,Fn(t),i)},finish:function(t){return e(r.f,t)}},e=function(t,e,o){r.p=n.prev,r.n=n.next;try{return t(e,o)}finally{n.next=r.n}}),n.resultName&&(n[n.resultName]=r.v,n.resultName=void 0),n.sent=r.v,n.next=r.n;try{return t.call(this,n)}finally{r.p=n.prev,r.n=n.next}}}return(Gn=function(){return{wrap:function(n,e,r,o){return t.w(i(n),e,r,o&&o.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,n){return new Dn(t,n)},AsyncIterator:Cn,async:function(t,n,e,o,a){return(r(n)?An:Bn)(i(t),n,e,o,a)},keys:Ln,values:Fn}})()}function Fn(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],e=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}throw new TypeError(Nn(t)+" is not iterable")}function Ln(t){var n=Object(t),e=[];for(var r in n)e.unshift(r);return function t(){for(;e.length;)if((r=e.pop())in n)return t.value=r,t.done=!1,t;return t.done=!0,t}}function Bn(t,n,e,r,o){var i=An(t,n,e,r,o);return i.next().then((function(t){return t.done?t.value:i.next()}))}function An(t,n,e,r,o){return new Cn(Mn().w(t,n,e,r),o||Promise)}function Cn(t,n){function e(r,o,i,a){try{var u=t[r](o),c=u.value;return c instanceof Dn?n.resolve(c.v).then((function(t){e("next",t,i,a)}),(function(t){e("throw",t,i,a)})):n.resolve(c).then((function(t){u.value=t,i(u)}),(function(t){return e("throw",t,i,a)}))}catch(t){a(t)}}var r;this.next||(Rn(Cn.prototype),Rn(Cn.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Rn(this,"_invoke",(function(t,o,i){function a(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function Mn(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var c=r&&r.prototype instanceof u?r:u,f=Object.create(c.prototype);return Rn(f,"_invoke",function(e,r,o){var i,u,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,e){return i=n,u=0,c=t,p.n=e,a}};function y(e,r){for(u=e,c=r,n=0;!l&&f&&!o&&n<s.length;n++){var o,i=s[n],y=p.p,v=i[2];e>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,p.v=r,p.n=i[1]):y<v&&(o=e<3||i[0]>r||r>v)&&(i[4]=e,i[5]=r,p.n=v,u=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,v){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,v),u=s,c=v;(n=u<2?t:c)||!l;){i||(u?u<3?(u>1&&(p.n=-1),y(u,c)):p.n=c:p.v=c);try{if(f=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==a)break}catch(n){i=t,u=1,c=n}finally{f=1}}return{value:n,done:l}}}(e,o,i),!0),f}var a={};function u(){}function c(){}function f(){}n=Object.getPrototypeOf;var s=[][r]?n(n([][r]())):(Rn(n={},r,(function(){return this})),n),l=f.prototype=u.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,Rn(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return c.prototype=f,Rn(l,"constructor",f),Rn(f,"constructor",c),c.displayName="GeneratorFunction",Rn(f,o,"GeneratorFunction"),Rn(l),Rn(l,o,"Generator"),Rn(l,r,(function(){return this})),Rn(l,"toString",(function(){return"[object Generator]"})),(Mn=function(){return{w:i,m:p}})()}function Rn(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Rn=function(t,n,e,r){function i(n,e){Rn(t,n,(function(t){return this._invoke(n,e,t)}))}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},Rn(t,n,e,r)}function Dn(t,n){this.v=t,this.k=n}function qn(t,n,e,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void e(t)}u.done?n(c):Promise.resolve(c).then(r,o)}function zn(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var i=t.apply(n,e);function a(t){qn(i,r,o,a,u,"next",t)}function u(t){qn(i,r,o,a,u,"throw",t)}a(void 0)}))}}function Hn(){return Yn.apply(this,arguments)}function Yn(){return(Yn=zn(Gn().mark((function t(){return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,navigator.serviceWorker.register("/service-worker.js");case 5:console.log("Service Worker registered"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),console.error("SW registration failed",t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))).apply(this,arguments)}function Wn(){return(Wn=zn(Gn().mark((function t(n){var e,r;return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.serviceWorker.ready;case 2:return e=t.sent,t.next=5,e.pushManager.getSubscription();case 5:r=t.sent,n.checked=!!r;case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Un(){return Jn.apply(this,arguments)}function Jn(){return(Jn=zn(Gn().mark((function t(){var n,e,r;return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=localStorage.getItem("token")){t.next=4;break}return alert("Silakan login terlebih dahulu"),t.abrupt("return");case 4:return t.next=6,navigator.serviceWorker.ready;case 6:return e=t.sent,t.next=9,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:(i="BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk",void 0,void 0,void 0,a="=".repeat(1),u=(i+a).replace(/-/g,"+").replace(/_/g,"/"),c=atob(u),Uint8Array.from((o=c,function(t){if(Array.isArray(t))return In(t)}(o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,n){if(t){if("string"==typeof t)return In(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?In(t,n):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(t){return t.charCodeAt(0)}))))});case 9:return r=t.sent,t.next=12,fetch("https://story-api.dicoding.dev/v1/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({endpoint:r.endpoint,keys:r.toJSON().keys})});case 12:alert("Push Notification aktif");case 13:case"end":return t.stop()}var o,i,a,u,c}),t)})))).apply(this,arguments)}function Vn(){return Kn.apply(this,arguments)}function Kn(){return(Kn=zn(Gn().mark((function t(){var n,e,r;return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=localStorage.getItem("token"),t.next=3,navigator.serviceWorker.ready;case 3:return e=t.sent,t.next=6,e.pushManager.getSubscription();case 6:if(r=t.sent){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,fetch("https://story-api.dicoding.dev/v1/notifications/subscribe",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({endpoint:r.endpoint})});case 11:return t.next=13,r.unsubscribe();case 13:alert("Push Notification dimatikan");case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}document.addEventListener("DOMContentLoaded",zn(Gn().mark((function t(){var n;return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Kt({content:document.querySelector("#main-content")}),t.next=3,n.renderPage();case 3:return window.addEventListener("hashchange",zn(Gn().mark((function t(){return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.renderPage();case 2:case"end":return t.stop()}}),t)})))),t.next=6,Hn();case 6:window.addEventListener("beforeinstallprompt",(function(t){t.preventDefault(),fn=t;var n=document.getElementById("installBtn");n&&(n.hidden=!1,n.addEventListener("click",zn(Gn().mark((function t(){return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return fn.prompt(),t.next=3,fn.userChoice;case 3:fn=null;case 4:case"end":return t.stop()}}),t)})))))})),e=void 0,(e=document.getElementById("pushToggle"))&&("Notification"in window&&"serviceWorker"in navigator?(function(t){Wn.apply(this,arguments)}(e),e.addEventListener("change",function(){var t=zn(Gn().mark((function t(n){return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.target.checked){t.next=5;break}return t.next=3,Un();case 3:t.next=7;break;case 5:return t.next=7,Vn();case 7:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}())):e.disabled=!0);case 8:case"end":return t.stop()}var e}),t)})))),window.addEventListener("online",(function(){!function(){_n.apply(this,arguments)}()}))})();